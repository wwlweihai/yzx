function config(localStorageServiceProvider,$ionicConfigProvider,RestangularProvider){localStorageServiceProvider.setPrefix("cn.rocksw.yzx").setStorageType("localStorage").setNotify(!0,!0),RestangularProvider.setBaseUrl("https://leancloud.cn/1.1"),RestangularProvider.setDefaultHeaders({"X-AVOSCloud-Application-Id":"zXmsYkXYionV4s9pHc3IKghD","X-AVOSCloud-Application-Key":"gHmRen4R5I3ziAE7wcP7vKw1"}),$ionicConfigProvider.views.transition("platform"),$ionicConfigProvider.tabs.position("bottom"),$ionicConfigProvider.backButton.text("").icon("ion-ios-arrow-left").previousTitleText(!1),$ionicConfigProvider.views.maxCache(0)}function routeConfig($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/tab/index"),$stateProvider.state("tab",{cache:!1,url:"/tab","abstract":!0,templateUrl:"modules/tabs.html",controller:"tabs"})}function exitRun($ionicPlatform,$ionicPopup){console.log("exitRun"),$ionicPlatform.registerBackButtonAction(function(){var confirmPopup=$ionicPopup.confirm({title:"易装修",template:"确定要退出程序？",cancelText:"取消",okText:"确定"});confirmPopup.then(function(res){res&&ionic.Platform.exitApp()})},100)}function signRun(localStorageService,rockswIonicToast,dataService,UserInfo,$rootScope,$ionicHistory){function activited(){function getUserInfoSuc(){return function(data){$rootScope.currentUserInfo=UserInfo.build(data.results[0])}}function getUserInfoErr(){return function(error){rockswIonicToast.show("获取用户信息失败,请检查网络!")}}if($rootScope.globals=localStorageService.get("globals")||{},$rootScope.globals.currentUser){$rootScope.isLogin=!0;var queryParams={where:{userId:$rootScope.globals.currentUser.id}};dataService.get("UserInfo",null,queryParams,getUserInfoSuc(),getUserInfoErr())}else $rootScope.isLogin=!1}console.log("pushRun"),ionic.Platform.ready(function(){activited()}),$rootScope.$on("userSignIn",function(event,data){localStorageService.set("globals",data),activited()}),$rootScope.$on("userSignOut",function(event,data){localStorageService.remove("globals"),$ionicHistory.clearCache(),activited()})}function yzxFreeExperience(rockswIonicToast,$scope){function experience(){rockswIonicToast.show("报名体验成功")}$scope.experience=experience}function tabs($rootScope,$state){$rootScope.$on("$ionicView.beforeEnter",function(){var stateName=$state.current.name;"tab.index"===stateName||"tab.style"===stateName||"tab.service"===stateName||"tab.self"===stateName?$rootScope.hideTabs=!1:$rootScope.hideTabs=!0})}function indexConfig($stateProvider){$stateProvider.state("tab.index",{url:"/index",views:{"tab-index":{templateUrl:"modules/index/index.html",controller:"index"}}}).state("tab.event",{url:"/event",views:{"tab-index":{templateUrl:"modules/index/event/event.html"}}}).state("tab.eventDetail",{url:"/eventDetail",views:{"tab-index":{templateUrl:"modules/index/event/eventDetail/eventDetail.html"}}}).state("tab.msg",{url:"/msg",views:{"tab-index":{templateUrl:"modules/index/msg/msg.html"}}}).state("tab.msgDetail",{url:"/msgDetail",views:{"tab-index":{templateUrl:"modules/index/msgDetail/msgDetail.html"}}}).state("tab.8+n",{url:"/8+n",views:{"tab-index":{templateUrl:"modules/index/8+n/8+n.html"}}}).state("tab.46xbz",{url:"/46xbz",views:{"tab-index":{templateUrl:"modules/index/46xbz/46xbz.html"}}}).state("tab.djsj",{url:"/djsj",views:{"tab-index":{templateUrl:"modules/index/djsj/djsj.html"}}}).state("tab.dxjg",{url:"/dxjg",views:{"tab-index":{templateUrl:"modules/index/dxjg/dxjg.html"}}}).state("tab.jpgj",{url:"/jpgj",views:{"tab-index":{templateUrl:"modules/index/jpgj/jpgj.html"}}}).state("tab.yxpp",{url:"/yxpp",views:{"tab-index":{templateUrl:"modules/index/yxpp/yxpp.html"}}}).state("tab.yzjq",{url:"/yzjq",views:{"tab-index":{templateUrl:"modules/index/yzjq/yzjq.html"}}}).state("tab.zygr",{url:"/zygr",views:{"tab-index":{templateUrl:"modules/index/zygr/zygr.html"}}})}function index(rockswIonicToast,Restangular,$rootScope,$scope){function signToday(){$rootScope.isLogin?rockswIonicToast.show("签到成功"):rockswIonicToast.show("请登录")}$scope.signToday=signToday}function styleConfig($stateProvider){$stateProvider.state("tab.style",{url:"/style",views:{"tab-style":{templateUrl:"modules/style/style.html",controller:"style"}}}).state("tab.styleDetail",{url:"/styleDetail",params:{id:1},views:{"tab-style":{templateUrl:"modules/style/styleDetail/styleDetail.html",controller:"styleDetail"}}}).state("tab.experience",{url:"/experience",views:{"tab-style":{templateUrl:"modules/style/experience/experience.html"}}})}function style(dataService,$state,Style,$scope){function getAllStyle(){dataService.getAll(Style.name,null,function(data){console.log(data),$scope.styleList=data.results})}getAllStyle()}function styleDetail(dataService,$stateParams,Style,$scope){function getStyle(){dataService.get(Style.name,styleId,null,function(data){$scope.style=data})}var styleId=$stateParams.id;getStyle()}function serviceConfig($stateProvider){$stateProvider.state("tab.service",{url:"/service",views:{"tab-service":{templateUrl:"modules/service/service.html"}}}).state("tab.checkOut",{url:"/checkOut",views:{"tab-service":{templateUrl:"modules/service/checkOut/checkOut.html"}}}).state("tab.superior",{url:"/superior",views:{"tab-service":{templateUrl:"modules/service/superior/superior.html",controller:"superior"}}}).state("tab.team",{url:"/team",views:{"tab-service":{templateUrl:"modules/service/team/team.html"}}}).state("tab.housekeeper",{url:"/housekeeper",views:{"tab-service":{templateUrl:"modules/service/housekeeper/housekeeper.html"}}}).state("tab.quote",{url:"/quote",views:{"tab-service":{templateUrl:"modules/service/quote/quote.html",controller:"quote"}}}).state("tab.quoteResult",{url:"/quoteResult",params:{quotePrice:"10000"},views:{"tab-service":{templateUrl:"modules/service/quote/quoteResult/quoteResult.html",controller:"quoteResult"}}})}function quote(rockswIonicToast,Restangular,$state,$rootScope,$scope){function subquote(formValidated){if(formValidated){var quotePrice=$scope.form.area*Number($scope.form.taocan.price)*1.5;$scope.form.area="",$state.go("tab.quoteResult",{quotePrice:quotePrice})}else rockswIonicToast.show("请正确输入房屋面积")}$scope.form={},$scope.subquote=subquote,$scope.taocanList=[{name:"实惠型",price:368},{name:"时尚型",price:568},{name:"豪华型",price:698}],$scope.form.taocan=$scope.taocanList[0]}function quoteResult($stateParams,$scope){$scope.quotePrice=$stateParams.quotePrice}function superior(Project,Team,rockswIonicToast,dataService,$timeout,$state,$rootScope,$scope){if(console.log(),$scope.hasProject=!1,$rootScope.isLogin){var queryParams={where:{userId:$rootScope.globals.currentUser.id}};dataService.get(Project.name,null,queryParams,function(data){console.log(data.results),$scope.hasProject=!0,$scope.project=Project.build(data.results[0]),$scope.jzTeam=Team.build($scope.project.jzTeam),$scope.sjTeam=Team.build($scope.project.sjTeam),$scope.jlTeam=Team.build($scope.project.jlTeam)},function(error){console.log(error)})}else rockswIonicToast.show("您尚未登录,无法查看"),$timeout(function(){$state.go("tab.service")},1500)}function selfConfig($stateProvider){$stateProvider.state("tab.self",{url:"/self",views:{"tab-self":{templateUrl:"modules/self/self.html",controller:"self"}}}).state("tab.signIn",{url:"/signIn",views:{"tab-self":{templateUrl:"modules/self/signIn/signIn.html",controller:"signIn"}}}).state("tab.signUp",{url:"/signUp",views:{"tab-self":{templateUrl:"modules/self/signUp/signUp.html",controller:"signUp"}}}).state("tab.status",{url:"/status",views:{"tab-self":{templateUrl:"modules/self/status/status.html",controller:"status"}}}).state("tab.information",{url:"/information",views:{"tab-self":{templateUrl:"modules/self/information/information.html",controller:"information"}}}).state("tab.collection",{url:"/collection",views:{"tab-self":{templateUrl:"modules/self/collection/collection.html"}}}).state("tab.jifen",{url:"/jifen",views:{"tab-self":{templateUrl:"modules/self/jifen/jifen.html"}}}).state("tab.feedback",{url:"/feedback",views:{"tab-self":{templateUrl:"modules/self/feedback/feedback.html"}}}).state("tab.recommendation",{url:"/recommendation",views:{"tab-self":{templateUrl:"modules/self/recommendation/recommendation.html"}}}).state("tab.setting",{url:"/setting",views:{"tab-self":{templateUrl:"modules/self/setting/setting.html",controller:"setting"}}})}function self(dataService,$state,$rootScope,$scope){}function signIn(rockswIonicToast,Restangular,$state,$rootScope,$scope){function subSignIn(formValidated){function signInSuc(){return function(data){if(console.log(data),data){rockswIonicToast.show("登录成功");var globals={currentUser:{id:data.objectId,username:data.username,sessionToken:data.sessionToken}};$state.go("tab.self",null,{reload:!0}),$rootScope.$broadcast("userSignIn",globals)}else console.log(data.mobilePhoneNumber),rockswIonicToast.show("请验证手机号")}}function signInErr(){return function(error){console.log(error.data);var errorCode=error.data.code;211==errorCode&&rockswIonicToast.show("用户名不存在"),210==errorCode&&rockswIonicToast.show("用户名和密码不匹配")}}formValidated?signInReq.get($scope.form,null).then(signInSuc(),signInErr()):rockswIonicToast.show("请输入用户名和密码")}var signInReq=Restangular.one("login");$scope.form={},$scope.subSignIn=subSignIn}function signUp(signUpService,rockswIonicToast,Restangular,$ionicModal,$timeout,$rootScope,$state,$scope){function subSignUp(){function signUpSuc(){return function(data){console.log(data),data&&(globals={currentUser:{id:data.objectId,username:data.username,sessionToken:data.sessionToken}},$scope.isSendVerifyCode=!0,$scope.verifyPhoneCodeModal.show(),verifyCodeBtnTout=$timeout(function(){$scope.isSendVerifyCode=!1},timeInterval))}}function signUpErr(){return function(error){console.log(error.data);var errorCode=error.data.code;214==errorCode&&rockswIonicToast.show("手机号码已经注册!")}}signUpService.subSignUp($scope.form,signUpSuc(),signUpErr())}function subVerifyCode(){function verifyCodeSuc(){return function(data){console.log("subVerifyCode return"+data),data&&(rockswIonicToast.show("注册成功"),$rootScope.$broadcast("userSignIn",globals),closeModal(),$state.go("tab.status"))}}function verifyCodeErr(){return function(error){603==errorCode&&rockswIonicToast.show("验证码错误!")}}var phoneCode=$scope.data.verifyCode;console.log(phoneCode),signUpService.subVerifyCode(phoneCode,verifyCodeSuc(),verifyCodeErr())}function cancelVerifyPhone(){function cancelSuc(){return function(data){rockswIonicToast.show("取消验证成功,请重新注册!"),closeModal()}}function cancelErr(){return function(error){rockswIonicToast.show("取消验证失败,请联系管理员注册!")}}var sessionHeader={"X-AVOSCloud-Session-Token":globals.currentUser.sessionToken};signUpService.deleteUser(globals.currentUser.id,sessionHeader,cancelSuc(),cancelErr())}function closeModal(){cancelVerifyCodeBtnTout(),$scope.verifyPhoneCodeModal.hide()}function cancelVerifyCodeBtnTout(){console.log("cancelVerifyCodeBtnTout"),$timeout.cancel(verifyCodeBtnTout)}var globals,verifyCodeBtnTout,timeInterval=6e4;$scope.form={},$scope.form.mobilePhoneNumber="",$scope.data={},$scope.isSendVerifyCode=!1,$scope.subSignUp=subSignUp,$scope.subVerifyCode=subVerifyCode,$scope.closeModal=closeModal,$scope.cancelVerifyPhone=cancelVerifyPhone,$ionicModal.fromTemplateUrl("modules/self/signUp/verifyPhoneCodeModal.html",{scope:$scope,animation:"slide-in-up"}).then(function(modal){$scope.verifyPhoneCodeModal=modal})}function signUpService(Restangular){function subSignUp(elementToPost,successCall,errorCall){signUpReq.post(null,elementToPost,null,header).then(function(data){successCall(data)},function(error){errorCall(error)})}function subVerifyCode(phoneCode,successCall,errorCall){verifyPhoneCodeReq.post(phoneCode,null,null,header).then(function(data){successCall(data)},function(error){errorCall(error)})}function deleteUser(userId,sessionHeader,successCall,errorCall){var deleteReq=Restangular.one("users",userId);deleteReq.remove(null,sessionHeader).then(function(data){successCall(data)},function(error){errorCall(error)})}var header={"Content-Type":"application/json"},signUpReq=Restangular.one("users"),verifyPhoneCodeReq=Restangular.one("verifyMobilePhone"),service={subSignUp:subSignUp,subVerifyCode:subVerifyCode,deleteUser:deleteUser};return service}function information(Restangular,$state,$scope){$scope.showPopup=function(){$scope.data={};var myPopup=$ionicPopup.show({template:'<input type="password" ng-model="data.wifi">',title:"Enter Wi-Fi Password",subTitle:"Please use normal things",scope:$scope,buttons:[{text:"Cancel"},{text:"<b>Save</b>",type:"button-positive",onTap:function(e){return $scope.data.wifi?$scope.data.wifi:void e.preventDefault()}}]});myPopup.then(function(res){console.log("Tapped!",res)}),$timeout(function(){myPopup.close()},3e3)}}function setting(Restangular,$state,$rootScope,$scope){function signOut(){$rootScope.$broadcast("userSignOut",null),$state.go("tab.self")}$scope.signOut=signOut}function status(UserInfo,dataService,$state,$rootScope,$scope){function updateRoomStatus(value){userInfo.setRoomStatus(value),dataService.save(userInfo.toString(),userInfo),console.log(JSON.stringify(userInfo)),console.log("change room "+value),$state.go("tab.index",null,{reload:!0})}var currentUser=$rootScope.globals.currentUser,userInfo=new UserInfo(currentUser.id,"",0,0);$scope.updateRoomStatus=updateRoomStatus}function dataService(Restangular,rockswIonicToast){function getAll(subRouter,queryParams,successCall,errorCall){var getRouter=baseRouter.one(subRouter);getRouter.get(queryParams).then(function(data){successCall(data)},function(error){errorCall?errorCall(error):rockswIonicToast.show("请求数据失败,请检查网络!")})}function get(subRouter,objectId,queryParams,successCall,errorCall){var getRouter=baseRouter.one(subRouter);getRouter.customGET(objectId,queryParams,header).then(function(data){successCall(data)},function(error){errorCall?errorCall(error):rockswIonicToast.show("请求数据失败,请检查网络!")})}function save(subRouter,subObejct){console.log("save object"),baseRouter.post(subRouter,subObejct,null,header).then(function(data){console.log(data)},function(error){console.log(error)})}function subVerifyCode(phoneCode,successCall,errorCall){verifyPhoneCodeReq.post(phoneCode,null,null,header).then(function(data){successCall(data)},function(error){errorCall(error)})}function deleteUser(userId,sessionHeader,successCall,errorCall){var deleteReq=Restangular.one("users",userId);deleteReq.remove(null,sessionHeader).then(function(data){successCall(data)},function(error){errorCall(error)})}var header={"Content-Type":"application/json"},baseRouter=Restangular.one("classes"),service={getAll:getAll,get:get,save:save,subVerifyCode:subVerifyCode,deleteUser:deleteUser};return service}angular.module("app",["app.run","app.core","app.value","app.config","app.service","app.object","app.directive","app.controller"]),angular.module("app.core",["ionic","rockswIonicComp","LocalStorageModule","restangular"]),angular.module("app.run",[]),angular.module("app.value",[]),angular.module("app.config",["ionic","app.value"]),angular.module("app.service",[]),angular.module("app.object",[]),angular.module("app.controller",[]),angular.module("app.directive",[]),angular.module("app.config").config(["localStorageServiceProvider","$ionicConfigProvider","RestangularProvider",config]),angular.module("app.config").config(["$stateProvider","$urlRouterProvider",routeConfig]),angular.module("app.run").run(["$ionicPlatform","$ionicPopup",exitRun]),angular.module("app.run").run(["localStorageService","rockswIonicToast","dataService","UserInfo","$rootScope","$ionicHistory",signRun]),angular.module("app.directive").directive("yzxFreeExperience",function(){function link(scope,element,attrs){}var directive={link:link,templateUrl:"modules/components/yzxFreeExperience/yzxFreeExperience.html",controller:"yzxFreeExperience",scope:{},restrict:"EA"};return directive}),angular.module("app.controller").controller("yzxFreeExperience",yzxFreeExperience),yzxFreeExperience.$inject=["rockswIonicToast","$scope"],angular.module("app.controller").controller("tabs",tabs),tabs.$inject=["$rootScope","$state","$scope"],angular.module("app.config").config(["$stateProvider",indexConfig]),angular.module("app.controller").controller("index",index),index.$inject=["rockswIonicToast","Restangular","$rootScope","$scope"],angular.module("app.config").config(["$stateProvider",styleConfig]),angular.module("app.controller").controller("style",style),style.$inject=["dataService","$state","Style","$scope"],angular.module("app.controller").controller("styleDetail",styleDetail),styleDetail.$inject=["dataService","$stateParams","Style","$scope"],angular.module("app.config").config(["$stateProvider",serviceConfig]),angular.module("app.controller").controller("quote",quote),quote.$inject=["rockswIonicToast","Restangular","$state","$rootScope","$scope"],angular.module("app.controller").controller("quoteResult",quoteResult),quoteResult.$inject=["$stateParams","$scope"],angular.module("app.controller").controller("superior",superior),superior.$inject=["Project","Team","rockswIonicToast","dataService","$timeout","$state","$rootScope","$scope"],angular.module("app.config").config(["$stateProvider",selfConfig]),angular.module("app.controller").controller("self",self),self.$inject=["dataService","$state","$rootScope","$scope"],angular.module("app.controller").controller("signIn",signIn),signIn.$inject=["rockswIonicToast","Restangular","$state","$rootScope","$scope"],angular.module("app.controller").controller("signUp",signUp),signUp.$inject=["signUpService","rockswIonicToast","Restangular","$ionicModal","$timeout","$rootScope","$state","$scope"],angular.module("app.service").factory("signUpService",signUpService),signUpService.$inject=["Restangular"],angular.module("app.controller").controller("information",information),information.$inject=["Restangular","$state","$scope"],angular.module("app.controller").controller("setting",setting),setting.$inject=["Restangular","$state","$rootScope","$scope"],angular.module("app.controller").controller("status",status),status.$inject=["UserInfo","dataService","$state","$rootScope","$scope"],angular.module("rockswIonicComp",["ionic"]).run(["$templateCache",function($templateCache){}]).provider("rockswIonicToast",function(){this.$get=["$compile","$document","$interval","$rootScope","$templateCache","$timeout",function($compile,$document,$interval,$rootScope,$templateCache,$timeout){var toastTimeout,toastTemplate='<div class="ionic_toast" ng-class="ionicToast.toastClass" ng-style="ionicToast.toastStyle" ng-click="hide()"><span class="ionic_toast_close" ng-click="hide()"><i class="ion-close-round toast_close_icon"></i></span><span ng-bind-html="ionicToast.toastMessage"></span></div>',defaultScope={toastClass:"",toastMessage:"",toastStyle:{display:"none",opacity:0}},toastPosition={top:"ionic_toast_top",middle:"ionic_toast_middle",bottom:"ionic_toast_bottom"},toastScope=$rootScope.$new(),toastTemplate=$compile(toastTemplate)(toastScope);toastScope.ionicToast=defaultScope,$document.find("body").append(toastTemplate);var toggleDisplayOfToast=function(display,opacity,callback){toastScope.ionicToast.toastStyle={display:display,opacity:opacity},toastScope.ionicToast.toastStyle.opacity=opacity,callback()};return toastScope.hide=function(){toggleDisplayOfToast("none",0,function(){})},{show:function(message,position,closeBtn,duration){$timeout.cancel(toastTimeout),message&&(duration||(duration=1800),position||(position="bottom"),duration>5e3&&(duration=5e3),angular.extend(toastScope.ionicToast,{toastClass:toastPosition[position]+" "+(closeBtn?"ionic_toast_sticky":""),toastMessage:message}),toggleDisplayOfToast("block",1,function(){closeBtn||(toastTimeout=$timeout(function(){toastScope.hide()},duration))}))},hide:function(){toastScope.hide()}}}]}),angular.module("app.controller").factory("UserInfo",function(){function UserInfo(userId,alias,roomstatus,roomarea){this.userId=userId,this.alias=alias,this.roomstatus=roomstatus,this.roomarea=roomarea}UserInfo.prototype.toString=function(){return UserInfo.name},UserInfo.prototype.setId=function(id){this.userId=id},UserInfo.prototype.setRoomStatus=function(value){this.roomstatus=value};var possibleRoles=["admin","editor","guest"];return UserInfo.possibleRoles=angular.copy(possibleRoles),UserInfo.build=function(data){return new UserInfo(data.userId,data.alias,data.roomstatus,data.roomarea)},UserInfo}),angular.module("app.controller").factory("Style",function(){function Style(objectId,name,avatar,images){this.objectId=objectId,this.name=name,this.avatar=avatar,this.images=images}return Style.prototype.toString=function(){return Style.name},Style.prototype.setId=function(id){this.objectId=id},Style.build=function(data){return new Style(data.objectId,data.name,data.avatar,data.images)},Style}),angular.module("app.controller").factory("Project",function(){function Project(objectId,userId,styleName,styleAvatar,roomInfo,startDate,endDate,jzTeam,sjTeam,jlTeam){this.objectId=objectId,this.userId=userId,this.styleName=styleName,this.styleAvatar=styleAvatar,this.roomInfo=roomInfo,this.startDate=startDate,this.endDate=endDate,this.jzTeam=jzTeam,this.sjTeam=sjTeam,this.jlTeam=jlTeam}return Project.prototype.toString=function(){return Project.name},Project.prototype.setId=function(id){this.objectId=id},Project.build=function(data){return new Project(data.objectId,data.userId,data.styleName,data.styleAvatar,data.roomInfo,data.startDate,data.endDate,data.jzTeam,data.sjTeam,data.jlTeam)},Project}),angular.module("app.controller").factory("Team",function(){function Team(objectId,name,avatar,type){this.objectId=objectId,this.name=name,this.avatar=avatar,this.type=type}return Team.prototype.toString=function(){return Team.name},Team.prototype.setId=function(id){this.objectId=id},Team.build=function(data){return new Team(data.objectId,data.name,data.avatar,data.type)},Team}),angular.module("app.service").factory("dataService",dataService),dataService.$inject=["Restangular","rockswIonicToast"];